/**
 * @modified $Author: 邓予喆 $
 * @version $Rev: a7416a35066df9a0d825efc4b9660cd33afe2470 $
 */
!function(e){require.config({enable_ozma:true});define("page/find/main/model",["tui/event","tui/net","module/login/login"],function(t,i,n){var a=t.extend({initialize:function(){var e=this;a.superClass.initialize.call(e);this.uid=n.getUserInfo()&&n.getUserInfo().uid||0;this.cookie_id=n.guid();e.op={callbackName:"callback",charset:"utf-8"};e.config={recommendNumber:12,anonymousRecommendNumber:12,loginStatus:n.isLogin(),req_id:"",session:e.randomStr(3),stime:0,hasNoData:false,maxRefreshCount:3}},getRecommendData:function(){var e=this,t;var n=e.config;if(n.loginStatus)t="http://ykrec.youku.com/find/packed/list.json?apptype=1&pg=23&module=10&pl="+n.recommendNumber+"&picSize=1&session="+n.session+"&uid="+e.uid+"&stime="+n.stime;else t="http://ykrec.youku.com/find/packed/list.json?apptype=1&pg=23&module=10&pl="+n.anonymousRecommendNumber+"&picSize=1&session="+n.session+"&stime="+n.stime;i.getJSON(t,{guid:e.cookie_id},function(t){var i=t.data;e.config.req_id=t.req_id;e.config.hasNoData=t.hasNoData;e.config.stime++;if("undefined"==typeof i||i.length<n.recommendNumber)e.trigger("recommend:none");else e.trigger("recommend:success",[i])},e.op)},getOneData:function(t,n){var a=this,r;var o=a.config;var s={};if(t)s=e.extend(t,{guid:a.cookie_id,fb_reqId:a.config.req_id,fb_type:1});else a.trigger("recommendOne:none",{vid:t.fb_id});if(o.loginStatus)r="http://ykrec.youku.com/find/packed/list.json?apptype=1&pg=23&module=10&pl=1&picSize=1&session="+o.session+"&uid="+a.uid+"&stime="+o.stime;else r="http://ykrec.youku.com/find/packed/list.json?apptype=1&pg=23&module=10&pl=1&picSize=1&session="+o.session+"&stime="+o.stime;i.getJSON(r,s,function(e){var i=e.data;a.config.req_id=e.req_id;a.config.hasNoData=e.hasNoData;a.config.stime++;if("undefined"==typeof i||0==i.length)a.trigger("recommendOne:none",{vid:t.fb_id});else a.trigger("recommendOne:success",{data:i,vid:t.fb_id})},a.op)},getExactRecommendData:function(){var t="http://ykatr.youku.com/atr/related/packed_list.json?site=1&apptype=1&pg=8&module=22",n={guid:this.cookie_id,pl:6,oc:"yksy_yngz"},a=this;if(a.config.loginStatus)n=e.extend(n,{uid:a.uid});i.getJSON(t,n,function(e){if(0==e.e){var t=e.data;if(t.length==n.pl)a.trigger("exactRec:success",[t])}},a.op)},randomStr:function(e){var t="0123456789qwertyuioplkjhgfdsazxcvbnm";var i="";var n=(new Date).getTime();for(var a=0;a<e;a++)i+=t.charAt(Math.ceil(1e8*Math.random())%t.length);return n+i}});return a});define("page/find/main/view/exactrec",["tui/net","tui/view","tui/art","tui/util/num","tui/util/date","page/find/main/model"],function(t,i,n,a,r,o){return i.extend({el:e("#exactrec"),events:{"click .yk-pack a":"reportLog"},initialize:function(){var e=this;this.data=new o;this.data.bind("exactRec:success",this.render.bind(this));e.data["getExactRecommendData"].call(e.data)},render:function(t){var i='<div class="yk-row">\n<% data.forEach(function(t, i){ %>\n<%log=encodeURIComponent(t.clickLogUrl)%>\n<div class="yk-col4 <%if (i==5){%>  colx  <%}else if(i==4){%> colxx <%}%>">\n<div class="yk-pack p-list"  log="<%=log%>">\n<div class="p-thumb">\n<a href="<%=t.playLink%>" title="<%=t.title%>" target="new"></a>\n<i class="bg"></i>\n<img class="quic" src="<%=t.picUrl%>">\n<i class="p-close"></i>\n</div>\n<ul class="p-info pos-bottom">\n<li class="status">\n<span class="p-time hover-hide">\n<i class="ibg"></i>\n</span>\n</li>\n</ul>\n<ul class="info-list">\n<li class="title ">\n<a href="<%=t.playLink%>" target="_blank"><%=t.title%></a>\n</li>\n</ul>\n</div>\n</div>\n<% }); %>\n</div>\n',a=n.compile(i)({data:t,encodeURIComponent:encodeURIComponent}),r=e(this.el);if(0!=r.length&&/<\/?[^>]*>/g.test(a)){r.append(a);r.closest(".mod").css("display","block")}},reportLog:function(i){var n=e(i.currentTarget).closest(".yk-pack").attr("log");n=decodeURIComponent(n);t.getRequest(n)}})});define("page/find/main/view/notice",["tui/view","tui/net","tui/cookie"],function(t,i,n){window.QheaderModule={initUnloginMessage:function(e){if(e&&e.length>0){var t=Math.round((new Date).getTime()/1e3);for(var a=0;a<e.length;a++){if("undefined"!=typeof e[a]["access_time"]&&!isNaN(parseInt(e[a]["access_time"]))&&t<parseInt(e[a]["access_time"]))continue;if("undefined"!=typeof e[a]["expire_time"]&&!isNaN(parseInt(e[a]["expire_time"]))&&t>parseInt(e[a]["expire_time"]))continue;var r="msgid_"+e[a]["msgid"];if(!n(r)){window.QheaderModule.renderMessage(e[a]);n(r,e[a]["msgid"]);i.getRequest("http://msg.youku.com/api/push/read_unlogin_msg?msgid="+e[a]["msgid"]);break}}}},renderMessage:function(t){var i=t.content,n=uid?1:0;var a="<div class='notice-wrap' loginstatus="+n+" data-msgid='"+t.msgid+"'><i></i><span><em>"+i.title+"：</em>"+i.ifo+"</span><a href='"+i.link+"' target='_blank' class='mbtn'>"+i.btnname+"</a><a id='closeNotice' href='javascript:;'></a> </div>";e("#"+window.nid).find(">.mod").append(a)}};var a=t.extend({el:e("#"+window.nid),events:{"click #closeNotice":"handleCloseNotice","click .mbtn":"reportClickLog"},initialize:function(){var e=this;if(0==this.$el.length)return;a.superClass.initialize.call(e);e.getNotice()},getNotice:function(){var e=this;if(uid){var t="http://msg.youku.com/api/push/getpopupmsg?"+CHUDA.API.getApiSignature();this.logurl="http://msg.youku.com/api/push/updatemsgstatus?"+CHUDA.API.getApiSignature();i.getJSON(t,{},function(t){if(void 0===t.errno||0!=t.errno)return;var n=t.data;if(n&&n.msgs&&n.msgs.length>0){window.QheaderModule.renderMessage(n.msgs[0]);i.getRequest(e.logurl+"&msgid="+n.msgs[0].msgid+"&status=1")}},{callbackName:"callback",charset:"utf-8"})}else{var t="http://static.youku.com/lvip/msg/chuda_message.js";i.getScript(t)}},reportClickLog:function(){var e=this.$el.find(".notice-wrap"),t=e.attr("loginstatus"),n=e.data("msgid");if(0==t){var a="http://msg.youku.com/api/push/click_unlogin_msg?msgid="+n;i.getRequest(a)}else if(this.logurl)i.getRequest(this.logurl+"&msgid="+n+"&status=2")},handleCloseNotice:function(){this.$el.find(".notice-wrap").hide()}});return a});define("page/find/main/view/recommend",["tui/net","module/login/login","tui/view","tui/art","tui/util/num","tui/util/date","page/find/main/model"],function(t,i,n,a,r,o,s){return n.extend({el:e("#ykRecommend"),video:"",mapData:{},hasDrawback:false,timer:{},events:{"click .feedback-btns a":"handleFeedback","click .rec-drawback":"handleDrawback","click .p-thumb a":"recClickLog","click .info-list a":"recClickLog","click .p-close":"removeDom","click #rec-login":"login"},initialize:function(){var t=this;this.recData=[];this.data=new s;this.config=this.data.config;this.data.bind("recommend:success",this.renderREC.bind(this));this.data.bind("recommend:none",this.dataNone.bind(this));this.data.bind("recommendOne:success",this.renderRecOne.bind(this));this.data.bind("recommendOne:none",this.oneDataNone.bind(this));t.data["getRecommendData"].call(t.data);if(0!=e(".yk-rec-refresh").length)e(".yk-rec-refresh").click(function(){t.refreshDom.call(t)})},renderREC:function(e){this.recData=e;this.renderData(e)},renderRecOne:function(t){var i=t.vid;var n=e("#ykRecommend .yk-pack[data-vid="+i+"]");if(this.hasDrawback||0==n.find(".rec-drawback").length)return;var a=t.data[0];var s='<div class="p-thumb"> <a href="'+a.playLink+'" title="'+a.title+'" target="new"></a><i class="bg"></i><img class="quic" src="'+a.picUrl+'"><i class="p-close"></i></div><ul class="p-info pos-bottom"><li class="status"> <span class="p-time hover-hide"> <i class="ibg"></i> <span>'+o.beautyTime(a.totalTime,false)+'</span> </span> </li></ul><ul class="info-list"> <li class="title"> <a href="'+a.playLink+'" target="_blank">'+a.title+"</a> </li> <li> <span >"+r.field(a.playAmount)+"次播放</span> <span>"+r.field(a.commentCount)+'次评论</span> </li> </ul><div class="feedback-cover"><div class="feedback-content"><i class="feedback-bg"></i><p>可以告诉小酷不喜欢的原因吗？</p><div class="feedback-btns" fblog="'+a.recFeedbackLogUrl+'"><a href="javascript:void(0)" class="blue" >猜的不准</a><a href="javascript:void(0)" class="gray">举报内容</a></div></div><div class="deleting"><p><span class="deleting-img"></span> <br/>正在删除...优化算法中</p><a href="javascript:;" class="rec-drawback">撤销</a> </div></div>';n.attr("data-vid",a.id).attr("log",a.recClickLogUrl).html(s)},renderData:function(t){var n='<% data.forEach(function(t, i){ %>\n<% if (config.loginStatus==true) { %>\n<% var module=1 %>\n<% }else { %>\n<% var module=3 %>\n<% } %>\n<%log=encodeURIComponent(t.recClickLogUrl)%>\n<%feedbackLog=encodeURIComponent(t.recFeedbackLogUrl)%>\n<% if (i%2==0) { %>\n<div class="yk-col4 <%if (i==10){%>  colx  <%}else if(i==8){%> colxx <%}%>">\n<% } %>\n<div class="yk-pack p-list <% if(i%2==0){%> mb20 <%}%>" data-vid="<%=t.id%>" log="<%=log%>">\n<div class="p-thumb">\n<a href="<%=t.playLink%>" title="<%=t.title%>" target="new"></a>\n<i class="bg"></i>\n<img class="quic" src="<%=t.picUrl%>">\n<i class="p-close"></i>\n</div>\n<ul class="p-info pos-bottom">\n<li class="status">\n<span class="p-time hover-hide">\n<i class="ibg"></i>\n<span><%=sec(t.totalTime,false)%></span>\n</span>\n</li>\n</ul>\n<ul class="info-list">\n<li class="title ">\n<a href="<%=t.playLink%>" target="_blank"><%=t.title%></a>\n</li>\n<li>\n<span><%=num(t.playAmount)%>次播放</span>\n<span><%=num(t.commentCount)%>次评论</span>\n</li>\n</ul>\n<div class="feedback-cover">\n<div class="feedback-content">\n<i class="feedback-bg"></i>\n<p>可以告诉小酷不喜欢的原因吗？</p>\n<div class="feedback-btns" fblog="<%=feedbackLog%>">\n<a href="javascript:void(0)" class="blue">猜的不准</a>\n<a href="javascript:void(0)" class="gray">举报内容</a>\n</div>\n</div>\n<div class=\'deleting\'><p><span class="deleting-img"></span> <br/>正在删除...优化算法中</p><a href=\'javascript:;\'\nclass=\'rec-drawback\'>撤销</a>\n</div>\n</div>\n</div>\n<% if (i%2==1){ %>\n</div>\n<% } %>\n<% }); %>\n',s=a.compile(n)({data:t,num:r.field,sec:o.beautyTime,encodeURIComponent:encodeURIComponent,config:this.config}),l=e("#ykRecommend"),u=l.closest(".mod");if(0!=l.find(".yk-row").length){l.removeClass("ajax-loading");l.find(".yk-row").empty().append(s)}else{var c=i.isLogin()?" <p>Hi~"+i.getUserInfo().username+"，看的视频越多，推荐的内容会越接近你“口味”哦~</p><div class='yk-row'>"+s+"</div> ":" <p>猜的不准么？<a id='rec-login' href='javascript:;'>登陆</a> 后再看看吧~~</p><div class='yk-row'>"+s+"</div> ";l.removeClass("ajax-loading").append(c)}u.css("display","block");this.trigger("refresh:success",[])},dataNone:function(){var t=e("#ykRecommend"),i=t.closest(".mod");t.removeClass("ajax-loading").addClass("ajax-none");t.empty().append("<p>去<a href='http://faxian.youku.com'>发现</a> 更多精彩吧</p>");e(".yk-rec-refresh").css("display","none");if(!i.is(":visible"))i.css("display","block")},oneDataNone:function(t){var i=t.vid||t;var n=e("#ykRecommend .yk-pack[data-vid="+i+"]");n.find(".deleting p").html("<div style='padding-top:27px'>&#40; ￣へ￣ &#41;<br/><br/>真的木有了哦~</div>");n.find(".deleting a").remove()},removeDom:function(t){var i=this,n=e(t.currentTarget),a=n.closest(".yk-pack").find(".feedback-cover");a.css("display","block");n.css("visibility","hidden")},refreshDom:function(){var t=this;e("#ykRecommend .yk-row").empty();e("#ykRecommend").addClass("ajax-loading");t.timer={};if("true"==t.config.hasNoData)var i=setTimeout(function(){t.dataNone();clearTimeout(i)},300);else t.data["getRecommendData"].call(t.data)},handleFeedback:function(i){i.preventDefault();var n=this,a=e(i.currentTarget),r={},o=a.parents(".yk-pack"),s=o.attr("data-vid");o.find(".p-close").css("visibility","visible");if(n.timer[s])clearTimeout(n.timer[s]);n.hasDrawback=false;o.find(".info-list").css("visibility","hidden");o.find(".deleting").fadeIn(500,function(){r.fb_id=s;r.fb_atype=a.hasClass("blue")?3:4;n.timer[s]=setTimeout(function(){clearTimeout(n.timer[s]);delete n.timer[s];if(n.hasDrawback)return;else{o.find(".deleting a").addClass("disabled");if("true"==n.config.hasNoData)var e=setTimeout(function(){n.oneDataNone(s);clearTimeout(e)},300);else n.data["getOneData"].call(n.data,r);var i=decodeURIComponent(a.parent().attr("fblog"));t.getRequest(i+"&type="+r.fb_atype)}},2e3)})},handleDrawback:function(t){if(e(t.currentTarget).hasClass("disabled"))return;var i=this,n=e(t.currentTarget).closest(".yk-pack"),a=n.find(".deleting"),r=n.attr("data-vid"),o=n.find(".info-list");i.hasDrawback=true;a.parent().hide();a.css("display","none");o.css("visibility","visible");if(i.timer[r])clearTimeout(i.timer[r])},recClickLog:function(i){var n=e(i.currentTarget).closest(".yk-pack").attr("log");n=decodeURIComponent(n);t.getRequest(n)},login:function(){i.login(function(){window.location.reload()})}})});define("page/find/main/view/fixmod",["tui/view","tui/art","tui/util/num"],function(t,i,n){var a=e(window);var r=t.extend({el:e("#FixMod"),initialize:function(t){var i=this,n;r.superClass.initialize.call(i);this.mods=e(".mod-fix");this.modPos=[];this.curIndex=-1;this.clickEvent=false;i.check();this.render();this.setCenter();a.scroll(function(){if(!i.clickEvent)i.initStatus()});a.bind("scroll resize",function(){n&&clearTimeout(n);n=setTimeout(function(){i.check.call(i)},100)})},events:{"click li":"goIndex"},render:function(){var t,i,n="";t=this;e.each(this.mods,function(t,i){n+='<li class="gray" data-stat-role="ck"><i class="fix-tip">'+e(i).attr("title")+'</i><img  src="'+e(i).attr("src")+'"/></li>'});this.$el.html(n);this.$el.find(">li").hover(function(){e(this).removeClass("gray")},function(){if(!e(this).hasClass("current"))e(this).addClass("gray")});this.initStatus();e("#sideBar").css("display","block")},check:function(){var t=e("body")[0];var i=t.className.match(/w(\d+)/)[1];var n=a.width();if(n-i<125||a.scrollTop()<350)e(this.el).fadeOut("fast");else e(this.el).fadeIn("fast");this.setCenter()},initStatus:function(){this.getCurIndex();this.setCurrent()},goIndex:function(t){var i,n,a;this.getPos();a=this;i=this.items.index(e(t.currentTarget));n=this.mods.eq(i).offset().top-200;this.clickEvent=true;e("body,html").animate({scrollTop:n},600,function(){a.curIndex=i;a.setCurrent();a.clickEvent=false})},getPos:function(){var t=this,i;this.items=this.$el.find("li");t.modPos=[];e.each(this.mods,function(n,a){i=e(a).parents(".mod").offset().top;t.modPos.push(i)})},getCurIndex:function(){var t=this,i,n,r=true;n=a.scrollTop();this.getPos();t.curIndex=-1;e.each(this.mods,function(e,i){if(t.modPos[e]>=n&&t.modPos[e]<=n+a.height()&&r){t.curIndex=e;r=false}})},setCurrent:function(){this.items.removeClass("current").addClass("gray");if(this.curIndex>=0)this.items.eq(this.curIndex).addClass("current").removeClass("gray")},setCenter:function(){var t=e("#sideBar"),i=e(".yk-header"),n=a.height()-e(i).height(),r=e(this.el).height(),o=parseInt((n-r)/2);if(o>135&&e(this.el).is(":visible"))e(this.el).css({bottom:o+"px"});else e(this.el).css({bottom:"135px"})}});return r});define("module/subscribe/curve-motion",[],function(){var t=.0017;var i=function(i,n,a){if(!e.isArray(i))return;if(e.isFunction(n)){a=n;n={}}this.options=n||(n={});if(n.easing)this._easing=n.easing;if(n.gravity)t=n.gravity;this.originX=i[0];this.originY=i[1];this.targetX=i[2];this.targetY=i[3];this.absX=Math.abs(this.targetX-this.originX);this.absY=Math.abs(this.targetY-this.originY);this.upward=this.targetY-this.originY<0;this.angle=180*Math.atan(this.absY/this.absX)/Math.PI;this.angle+=Math.cos(this.angle*Math.PI/180)*(n.elevationAngle||0);this.rad=this.angle*Math.PI/180;this.speed=Math.sqrt(t*this.absX*this.absX/(2*(this.absX*Math.tan(this.rad)-this.absY)),2)/Math.cos(this.rad);this.duration=this.absX/(this.speed*Math.cos(this.rad));this.draw=this.draw.bind(this);this._completeCallback=e.isFunction(a)&&a||function(){}};i.prototype={draw:function(){var e=+new Date-this.startTime;e=Math.min(e/this.duration,1);e=this._easing(e);if(e<1&&!this._paused)a(this.draw);var t=this._calcX(this.originX,this.targetX,e);var i=this._calcY(Math.abs(this.upward?t-this.originX:this.targetX-t));if(this._frameTimer)clearTimeout(this._frameTimer);var n=this;n._frameTimer=setTimeout(function(){if(n._useTransform)n._updateCallback(t-n.originX,n.upward?-i:n.absY-i);else n._updateCallback(t,n.upward?n.originY-i:n.targetY-i);if(1==e)n._completeCallback(t,i)},0)},start:function(){this._paused=false;this.startTime=+new Date;this.draw()},pause:function(){this._paused=true},updateFrame:function(e,t){this._updateCallback=e;this._useTransform=!!t},_calcX:function(e,t,i){return e+(t-e)*i},_calcY:function(e){return e*Math.tan(this.rad)-t*e*e/(2*Math.pow(this.speed*Math.cos(this.rad),2))},_easing:function(e){return e*e*(3-2*e)}};var n=!!(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame);var a=window.requestAnimationFrame||function(){var e=0;return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){var i=(new Date).getTime(),n;n=Math.max(0,16-(i-e));e=i+n;return setTimeout(function(){t(i+n)},n)}}();i.supportCSSTransform=n;return i});define("module/subscribe/curvefly",["tui/view","module/subscribe/curve-motion"],function(t,i){var n;var a=t.extend({initialize:function(){this._coords=this.options.coords;this._picurl=this.options.picurl||null;this._motion=new i(this._coords,{elevationAngle:this.options.elevationAngle||33},this._complete.bind(this));this._motion.updateFrame(this._update.bind(this),i.supportCSSTransform);this.render()},remove:function(){a.superClass.remove.call(this)},render:function(){var t=this._picurl;if(!(t&&t.indexOf("&#x")!==-1)){t=this._picurl?'<img src="'+this._picurl+'" />':'<i class="iconfont">&#xe637;</i>';var i=e('<div class="g-subs-ani">'+t+"</div>")}else var i=e('<div class="g-subs-ani g-curvefly-wrap">'+t+"</div>");i.css({left:this._coords[0],top:this._coords[1]});e(document.body).append(i);this.setElement(i)},start:function(){this.$el.show();this._motion.start()},pause:function(){this._motion.pause()},_update:function(e,t){if(i.supportCSSTransform)this.$el.get(0).style[r+"Transform"]="translate3d("+e+"px, "+t+"px, 0)";else this.$el.css({left:e,top:t})},_complete:function(){var e=this.$el;if(i.supportCSSTransform)e.get(0).style[r+"Transform"]="none";e.css({left:this._coords[2],top:this._coords[3]}).fadeOut(300)}});a.create=function(e,t,i,r,o,s){a.destory();n=new a({coords:[e,t,i,r],picurl:o,elevationAngle:s});return n};a.destory=function(){if(n){n.remove();n=null}};var r="";var o=document.createElement("div");e.each({Webkit:"webkit",Moz:"moz",O:"o",ms:"ms"},function(e,t){if(void 0!==o.style[e+"TransitionProperty"]){r=e;return false}});return a});define("module/subscribe/subscribe",["tui/event","module/login/login","tui/net","module/subscribe/curvefly"],function(t,i,n,a){var r=t.extend({initialize:function(t){var n=this;r.superClass.initialize.call(n);n.loading=false;if(!t.box)return;n.CACHE={};setTimeout(function(){n.checkSub(t.box)},0);e(document).bind("login",function(){n.checkSub(t.box)});if(t.cSub)n.bind("sub:sucess",t.cSub.bind(n));if(t.update)n.bind("update:sucess",t.update.bind(n));e(".sub-action",t.box).bind("click",function(t){t.preventDefault();if(n.loading)return;n.loading=true;var a=e(this),r=a.attr("data-id"),o=a.attr("data-log"),s=a.attr("data-img"),l={addtion:o},u=n.CACHE[r];i.login(function(){if(a.hasClass("sub-done")){a.addClass("sub-done-loading").text("取消中");l.unfollow=r}else{if(s)n.animate(s,a);l.follow=r}n.sub.apply(n,[a,l])});if(!i.isLogin())n.loading=false});e(".sub-action",t.box).hover(function(){var t=e(this);if(t.hasClass("sub-done")&&!t.hasClass("sub-done-loading"))t.addClass("sub-done-hover").text("取消订阅")},function(){var t=e(this);if(t.hasClass("sub-done")&&!t.hasClass("sub-done-loading"))t.removeClass("sub-done-hover").text("已订阅");else if(!t.hasClass("sub-done-loading"))t.removeClass("sub-done-hover").removeClass("sub-add-hover").text("订阅")})},animate:function(t,i){var n=e("#qheader_sub_num").parent().offset();var r=n.left+8;var o=n.top;var s=i.offset();var l=s.left+8;var u=s.top-4;a.create(l,u,r,o,t,18).start()},checkSub:function(t){var i=this;var a=target_array_uid=[];var r={};if(!uid)return;e(t).find(".sub-action").each(function(t,n){var a=e(n).attr("data-id"),r=CHUDA.Common.encodeUid(a);target_array_uid.push('"'+r+'"');if(i.CACHE[r])i.CACHE[r].el.push(n);else i.CACHE[r]={follow:a,encodeUid:r,el:[n]}});if(!target_array_uid.length)return;url="http://yws.youku.com/friendships/js_show.json?source_uid="+CHUDA.Common.encodeUid(uid)+"&target_array_uid=["+target_array_uid.join(",")+"]&t="+1*new Date;n.getJSON(url,{},function(t){if(1==t.error)e(t.target).each(function(e,t){var n=i.CACHE[t.id];if(!n.el)return;if(t.followed)i.subed(n.el);else i.unsubed(n.el)})},{callbackName:"callback",traditional:true})},update:function(t){var i=this;e(t).each(function(t,n){if(e(n).hasClass("sub-done"))i.unsubed(n);else i.subed(n);i.trigger("update:sucess",[e(n)])})},subed:function(t){e(t).removeClass("sub-add-hover").addClass("sub-done").html("已订阅")},unsubed:function(t){e(t).removeClass("sub-done sub-done-loading").addClass("sub-add-hover").html("订阅")},sub:function(t,i){var a=this;n.getJSON("http://i.youku.com/u/subToUpdates",i,function(i){if(1==i){a.update(t);a.trigger("sub:sucess",[t]);if(e(t).hasClass("sub-done"))e(t).removeClass("sub-done-hover")}a.loading=false},{callbackName:"callback",charset:"utf-8"})}});return r});define("module/ui/switchtab",["tui/lazyImageLoader","tui/event"],function(t,i){jQuery.easing["jswing"]=jQuery.easing["swing"];jQuery.extend(jQuery.easing,{easeInOutQuad:function(e,t,i,n,a){if((t/=a/2)<1)return n/2*t*t*t+i;return n/2*((t-=2)*t*t+2)+i}});function n(t){if(t&&t.tagName){var i="a"==t.tagName.toLowerCase()?e(t):e(t).find("a");i=i.length?i:e(t);return(i.attr("rel")||i.attr("href").replace(/.*#(\d+)$/,"$1")||1)-1}else return 0}function a(e){var t=arguments;for(var i=0,n=t.length;i<n;i++){var e=t[i];if(e)clearTimeout(e)}return null}var r=i.extend({initialize:function(i){var o=this;r.superClass.initialize.apply(o,arguments);o.op=i||{};o.op.slide=i.slide||false;o.op.linktab=i.linktab||false;o.op.clicktab=i.clicktab||false;o.op.lazyContent=i.lazyContent||window.gLazyContent||false;var s=o.box=e(i.box);var l=o.tab=e(i.tab||".tab li",s);var u=o.panel=e(i.panel||".c",s);o.size=l.length||u.length;o.loop=i.loop||0;o.current=n(l.filter(".current")[0]);if(o.op.slide){o.scroll=u.parent().parent();o.scroll.scrollLeft(0);t({imgs:u.eq(o.current).find(".lazyImg")});u.parent().append(u.eq(0).clone());o.panel=e(i.panel||".c",s);o.width=u.width();o.delay=i.delay||700;o.loop=(o.loop||5e3)+o.delay;o.anilock=false}if(o.size<2)return;if(o.op.clicktab)l.click(function(e){e.preventDefault();o.go(n(this))});else{if(!o.op.linktab)l.click(function(e){e.preventDefault()});l.mouseenter(function(){a(o.timer,o.looptimer);var e=this;o.timer=setTimeout(function(){o.go(n(e))},30)}).mouseleave(function(){a(o.timer,o.looptimer);o.start()})}if(o.loop){o.check(o.op.clicktab?l:null);o.start()}l.parent().on("click","a",function(t){var i=e(this).attr("href");if(!i||"#"==i||i.length<5)t.preventDefault()})},on:function(e,t){this.box.eventProxy(e,t);return this},go:function(e,t){var i=this;e=t?e:Math.min(Math.max(e,0),i.size-1);i.trigger("before",[i.current,e,i]);if(i.op.slide){if(i.anilock){i.nextstep=function(){i.animate(e,t)};return}i.animate(e,t)}else{var n=i.current;i.current=e%i.size;i.trigger("change",[i.current,i]);i.tab.removeClass("current").eq(i.current).addClass("current");var a=i.op.fade;var r=i.panel;a?r.eq(n).stop().fadeOut(100):r.hide();r.eq(i.current)[a?"fadeIn":"show"](i.op.duration?i.op.duration:0);i.trigger("after",[i.current,i])}},prev:function(e){this.go(this.current-1,e)},next:function(e){this.go(this.current+1,e)},start:function(e){var t=this;if(t.loop){a(t.looptimer);if(e)t.start();t.looptimer=setTimeout(function(){t.start();t.next(true)},t.loop)}},stop:function(){a(this.looptimer)},check:function(e){var t=this;(e||t.panel).mouseenter(function(){a(t.looptimer)}).mouseleave(function(){a(t.looptimer);t.start()})},animate:function(e,i){var n=this;var r=n.current;if(n.anilock||r==e)return;a(n.looptimer);var o=n.size,s=n.width,l=n.panel,u=n.scroll;var c=r>e?0:s;var d=r>e?s:0;e%=i?o+1:o;t({imgs:l.eq(e).show().find(".lazyImg")});u.scrollLeft(d);n.tab.removeClass("current").eq(e%o).addClass("current");u.animate({scrollLeft:c},n.delay,"easeInOutQuad",function(){l.eq(r).hide();if(i&&e==o){e%=o;t({imgs:l.eq(0).show().find(".lazyImg")});l.eq(o).hide()}u.scrollLeft(0);n.current=e;n.anilock=false;n.trigger("after",[n.current,n]);if(n.nextstep){n.nextstep();n.nextstep=null}if(i)n.start()});n.anilock=true}});return r});define("page/find/main/switchtab",["module/ui/switchtab","tui/lazyImageLoader","tui/slide2","module/subscribe/subscribe","tui/event","module/ad/ad"],function(t,i,n,a,r,o){return function(){var r=e(".modSwitch");r.delegate("a","click",function(t){var i=e(this).attr("href");if(!i||"#"==i)t.preventDefault()});if(r[0])r.each(function(r,s){var l=new t({box:s,tab:".t_tab li",panel:".tab-c",linktab:true});l.bind("change",function(t){var r=l.panel.eq(t);var s=r.children().eq(0);if(s.hasClass("lazyContent")){r.html(s.val());i({imgs:r.find(".lazyImg")});o.tabInit(r);setTimeout(function(){n(r);new a({box:r,cSub:function(t){var i=t.data("id");var n=t.attr("class");e(".sub-action[data-id="+i+"]").each(function(i,a){if(a==t[0])return;else e(a).removeClass().addClass(n).html(t.html())})}});e(document).trigger("tab:changed");e(document).trigger("domChanged")},200)}})})}});require(["page/find/g","module/subscribe/subscribe","tui/slide2","page/find/main/switchtab","page/find/main/view/fixmod","page/find/main/view/recommend","page/find/main/view/notice","page/find/main/view/exactrec"],function(t,i,n,a,r,o,s,l){t.init();var u=new r;var c=new o;c.bind("refresh:success",function(){u.initStatus()});var d=new i({box:e(".yk-content")});n();a();new s;new l})}(window.jQuery);;